generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "windows"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id         Int       @id @default(autoincrement())
  name       String    @unique(map: "uq_user_name") @db.VarChar(15)
  is_deleted Boolean   @default(false)
  deleted_at DateTime? @db.DateTime(0)
  created_at DateTime  @default(now()) @db.DateTime(0)
  post       post[]

  @@map("user")
}

model aiAnalysis {
  id                  Int                             @id @default(autoincrement())
  post_id             Int                             @unique(map: "uq_aiAnalysis_post")
  signal_noise_result aiAnalysis_signal_noise_result?
  created_at          DateTime                        @default(now()) @db.DateTime(0)
  post                post                            @relation(fields: [post_id], references: [id], onDelete: Cascade, map: "fk_aiAnalysis_post")
  aiAnalyzedEmotion   aiAnalyzedEmotion[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model aiAnalyzedEmotion {
  id          Int        @id @default(autoincrement())
  analysis_id Int
  emotion_id  Int
  percentage  Decimal    @db.Decimal(5, 2)
  aiAnalysis  aiAnalysis @relation(fields: [analysis_id], references: [id], onDelete: Cascade, map: "fk_aie_analysis")
  emotion     emotion    @relation(fields: [emotion_id], references: [id], map: "fk_aie_emotion")

  @@unique([analysis_id, emotion_id], map: "uq_aie_analysis_emotion")
  @@index([analysis_id], map: "idx_aie_analysis_id")
  @@index([emotion_id], map: "idx_aie_emotion_id")
}

model emotion {
  id                  Int                   @id @default(autoincrement())
  post_id             Int
  emotion_name        emotion_name          
  modified            Boolean               @default(false)
  aiAnalyzedEmotion   aiAnalyzedEmotion[]
  userSelectedEmotion userSelectedEmotion[]
   post                post                  @relation(fields: [post_id], references: [id], onDelete: Cascade, map: "fk_emotion_post")
}

model oneLine {
  id      Int    @id @default(autoincrement())
  post_id Int
  content String @db.VarChar(50)
  post    post   @relation(fields: [post_id], references: [id], onDelete: Cascade, map: "fk_oneLine_post")

  @@index([post_id], map: "fk_oneLine_post")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model post {
  id                  Int                   @id @default(autoincrement())
  user_id             Int
  date                DateTime?             @db.DateTime(0)
  title               String?               @db.VarChar(100)
  content             String                @db.VarChar(500)
  is_deleted          Boolean               @default(false)
  deleted_at          DateTime?             @db.DateTime(0)
  photo_url           String?               @db.Text
  created_at          DateTime              @default(now()) @db.DateTime(0)
  book_mark           Boolean               @default(false)
  signal_noise        post_signal_noise     @default(signal)
  aiAnalysis          aiAnalysis?
  oneLine             oneLine[]
  user                User                  @relation(fields: [user_id], references: [id], map: "fk_post_user")
  userSelectedEmotion userSelectedEmotion[]
  emotion             emotion[]

  @@index([user_id], map: "idx_post_user_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model userSelectedEmotion {
  id         Int     @id @default(autoincrement())
  post_id    Int
  emotion_id Int
  is_saved   Boolean @default(false)
  percentage Decimal @db.Decimal(5, 2)
  emotion    emotion @relation(fields: [emotion_id], references: [id], map: "fk_use_emotion")
  post       post    @relation(fields: [post_id], references: [id], onDelete: Cascade, map: "fk_use_post")

  @@unique([post_id, emotion_id], map: "uq_use_post_emotion")
  @@index([emotion_id], map: "idx_use_emotion_id")
  @@index([post_id], map: "idx_use_post_id")
}

enum aiAnalysis_signal_noise_result {
  Signal
  Noise
}

enum post_signal_noise {
  signal
  noise
}

enum emotion_name {
  Boredom
  Worried
  Smile
  Joyful
  Happy
  Angry
  Shameful
  Unrest
  Afraid
  Sad
}